steps:
- name: node
  entrypoint: npm
  args: ['install']
- name: node
  entrypoint: npm
  args: ['test']
- name: node
  entrypoint: npm
  args: ['run', 'build']
  env:
    - 'PORT=${_PORT}'
    - 'SERVICE_ACCOUNT_EMAIL=${_SERVICE_ACCOUNT_EMAIL}'
    - 'SERVICE_ACCOUNT_PRIVATE_KEY=${_SERVICE_ACCOUNT_PRIVATE_KEY}'
  - name: 'gcr.io/cloud-builders/gcloud'
  args: ['app', 'deploy']
  env:
    - 'PORT=${_PORT}'
    - 'SERVICE_ACCOUNT_EMAIL=${_SERVICE_ACCOUNT_EMAIL}'
    - 'SERVICE_ACCOUNT_PRIVATE_KEY=${_SERVICE_ACCOUNT_PRIVATE_KEY}'
  timeout: '1600s'

tags: ['forensic-architecture', 'datasheet-server', 'project-name']
